<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maintainers &mdash; Exegol 4.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/logo_round.ico"/>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sponsors" href="sponsors.html" />
    <link rel="prev" title="Contributors" href="contributors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Exegol
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/install.html">Install Exegol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/updates.html">Updates</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Exegol Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../the-exegol-project/python-wrapper.html">Python Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-exegol-project/docker-images.html">Docker images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../the-exegol-project/offline-resources.html">Offline resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exegol wrapper</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/install.html"><code class="code docutils literal notranslate"><span class="pre">install</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/start.html"><code class="code docutils literal notranslate"><span class="pre">start</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/info.html"><code class="code docutils literal notranslate"><span class="pre">info</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/exec.html"><code class="code docutils literal notranslate"><span class="pre">exec</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/update.html"><code class="code docutils literal notranslate"><span class="pre">update</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/stop.html"><code class="code docutils literal notranslate"><span class="pre">stop</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/restart.html"><code class="code docutils literal notranslate"><span class="pre">restart</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/remove.html"><code class="code docutils literal notranslate"><span class="pre">remove</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/uninstall.html"><code class="code docutils literal notranslate"><span class="pre">uninstall</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/version.html"><code class="code docutils literal notranslate"><span class="pre">version</span></code> action</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-wrapper/advanced-uses.html">Advanced uses</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exegol image</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exegol-image/credentials.html">Credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exegol-image/my-resources.html">My resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exegol resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exegol-resources/intro.html">Intro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="users.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributors.html">Contributors</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Maintainers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wrapper-release">Wrapper release</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preparation">Preparation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#git-updates">1. Git updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="#config-reviews">2. Config reviews</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tests-build">Tests &amp; build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-build">Post build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#upload">Upload</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-deploy">Post-Deploy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#images-release">Images release</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prepare-changes">Prepare changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merge-changes">Merge changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-tag">New tag</a></li>
<li class="toctree-l3"><a class="reference internal" href="#publish-release">Publish release</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ci-cd-pipeline">CI/CD Pipeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#github-actions">GitHub Actions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-secrets">1. Setting up secrets</a></li>
<li class="toctree-l4"><a class="reference internal" href="#deploying-a-runner">2. Deploying a runner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#checking-runners-status">3. Checking runners status</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understanding-the-pipelines">4. Understanding the pipelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#common-errors">4. Common errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sponsors.html">Sponsors</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Exegol</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Maintainers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/community/maintainers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="maintainers">
<h1><a class="toc-backref" href="#id2" role="doc-backlink">Maintainers</a><a class="headerlink" href="#maintainers" title="Permalink to this heading"></a></h1>
<p>This part of the documentation is meant for Exegol maintainers.</p>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#maintainers" id="id2">Maintainers</a></p>
<ul>
<li><p><a class="reference internal" href="#wrapper-release" id="id3">Wrapper release</a></p>
<ul>
<li><p><a class="reference internal" href="#preparation" id="id4">Preparation</a></p>
<ul>
<li><p><a class="reference internal" href="#git-updates" id="id5">1. Git updates</a></p></li>
<li><p><a class="reference internal" href="#config-reviews" id="id6">2. Config reviews</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tests-build" id="id7">Tests &amp; build</a></p></li>
<li><p><a class="reference internal" href="#post-build" id="id8">Post build</a></p></li>
<li><p><a class="reference internal" href="#upload" id="id9">Upload</a></p></li>
<li><p><a class="reference internal" href="#post-deploy" id="id10">Post-Deploy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#images-release" id="id11">Images release</a></p>
<ul>
<li><p><a class="reference internal" href="#prepare-changes" id="id12">Prepare changes</a></p></li>
<li><p><a class="reference internal" href="#merge-changes" id="id13">Merge changes</a></p></li>
<li><p><a class="reference internal" href="#new-tag" id="id14">New tag</a></p></li>
<li><p><a class="reference internal" href="#publish-release" id="id15">Publish release</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ci-cd-pipeline" id="id16">CI/CD Pipeline</a></p>
<ul>
<li><p><a class="reference internal" href="#github-actions" id="id17">GitHub Actions</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-up-secrets" id="id18">1. Setting up secrets</a></p></li>
<li><p><a class="reference internal" href="#deploying-a-runner" id="id19">2. Deploying a runner</a></p></li>
<li><p><a class="reference internal" href="#checking-runners-status" id="id20">3. Checking runners status</a></p></li>
<li><p><a class="reference internal" href="#understanding-the-pipelines" id="id21">4. Understanding the pipelines</a></p></li>
<li><p><a class="reference internal" href="#common-errors" id="id22">4. Common errors</a></p>
<ul>
<li><p><a class="reference internal" href="#docker-login" id="id23">1. docker login</a></p></li>
<li><p><a class="reference internal" href="#disk-space" id="id24">2. Disk space</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="wrapper-release">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Wrapper release</a><a class="headerlink" href="#wrapper-release" title="Permalink to this heading"></a></h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The wrapper documentation must be aligned with the wrapper features. Make sure to add code to the appropriate <a class="reference external" href="https://github.com/ThePorgs/Exegol-docs">Exegol docs</a> branch and have a pull request ready. The docs PR can be merged once the wrapper is released.</p>
</div>
<section id="preparation">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Preparation</a><a class="headerlink" href="#preparation" title="Permalink to this heading"></a></h3>
<section id="git-updates">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">1. Git updates</a><a class="headerlink" href="#git-updates" title="Permalink to this heading"></a></h4>
<p>The first step is to update the project and sub-modules, meaning pointing the exegol-images and exegol-resources sub-modules to the latest master version.
Even if the wrapper is able to auto-update itself, it is always better to keep the base reference at least up to date.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">With git</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">With Exegol</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><ul class="simple">
<li><p>Update current wrapper repo:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>pull
</pre></div>
</div>
<ul class="simple">
<li><p>Update git submodules and checkout to <strong>main</strong> branch for release:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>-C<span class="w"> </span>exegol-docker-build<span class="w"> </span>checkout<span class="w"> </span>main
git<span class="w"> </span>-C<span class="w"> </span>exegol-docker-build<span class="w"> </span>pull
git<span class="w"> </span>-C<span class="w"> </span>exegol-resources<span class="w"> </span>checkout<span class="w"> </span>main
git<span class="w"> </span>-C<span class="w"> </span>exegol-resources<span class="w"> </span>pull
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>Update to the latest version of the <strong>main</strong> branches (checkout if needed, <strong>except for the wrapper</strong> which remains in branch dev)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>exegol<span class="w"> </span>update<span class="w"> </span>-v
</pre></div>
</div>
</div></div>
</section>
<section id="config-reviews">
<h4><a class="toc-backref" href="#id6" role="doc-backlink">2. Config reviews</a><a class="headerlink" href="#config-reviews" title="Permalink to this heading"></a></h4>
<ul>
<li><p>Review exegol.utils.ConstantConfig variables</p>
<blockquote>
<div><ul class="simple">
<li><p>Change version number ! (remove the alpha or beta tag at the end of the version number)</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Review documentation</p></li>
<li><p>Review README.md</p></li>
</ul>
</section>
</section>
<section id="tests-build">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Tests &amp; build</a><a class="headerlink" href="#tests-build" title="Permalink to this heading"></a></h3>
<p>You can execute this one-liner to check the project and build it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Require</strong> <a class="reference external" href="https://packaging.python.org/en/latest/tutorials/packaging-projects/#generating-distribution-archives">build</a> package installed!</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Exegol can only be published through a <strong>source</strong> build distribution because of the source code files for building local images.</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>setup.py<span class="w"> </span>clean<span class="w"> </span><span class="nb">test</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="o">(</span>rm<span class="w"> </span>-rf<span class="w"> </span>Exegol.egg-info<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>python3<span class="w"> </span>-m<span class="w"> </span>build<span class="w"> </span>--sdist<span class="o">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="se">\</span>
<span class="w">   </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Some tests failed, check your code and requirements before publishing!&quot;</span>
</pre></div>
</div>
</section>
<section id="post-build">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Post build</a><a class="headerlink" href="#post-build" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Upgrade tests.test_exegol.py version number to the next version build to avoid future mistake</p></li>
<li><p>Commit updates</p></li>
<li><p>Publish PR</p></li>
<li><p>Wait for review and merge</p></li>
</ul>
</section>
<section id="upload">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Upload</a><a class="headerlink" href="#upload" title="Permalink to this heading"></a></h3>
<p>After validation of the PR, we can upload the new version package to pypi.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Require</strong> <a class="reference external" href="https://packaging.python.org/en/latest/tutorials/packaging-projects/#uploading-the-distribution-archives">twine</a> package installed and token configured on <code class="docutils literal notranslate"><span class="pre">~/.pypirc</span></code>!</p>
</div>
<ul class="simple">
<li><p>Check package upload on the test repository (optional)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>twine<span class="w"> </span>upload<span class="w"> </span>--repository<span class="w"> </span>testpypi<span class="w"> </span>dist/*<span class="w"> </span>--verbose
</pre></div>
</div>
<ul class="simple">
<li><p>Upload to the production repository</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>twine<span class="w"> </span>upload<span class="w"> </span>dist/*
</pre></div>
</div>
</section>
<section id="post-deploy">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Post-Deploy</a><a class="headerlink" href="#post-deploy" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Create new github release with new version tag</p></li>
<li><p>Fast-forward dev branch to the latest master commit</p></li>
<li><p>Change the wrapper version on the dev branch to <code class="docutils literal notranslate"><span class="pre">x.y.zb1</span></code></p></li>
</ul>
</section>
</section>
<section id="images-release">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Images release</a><a class="headerlink" href="#images-release" title="Permalink to this heading"></a></h2>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The images documentation must be aligned with the images features. Make sure to add code to the appropriate <a class="reference external" href="https://github.com/ThePorgs/Exegol-docs">Exegol docs</a> branch and have a pull request ready. The docs PR can be merged once the images are released.</p>
</div>
<section id="prepare-changes">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Prepare changes</a><a class="headerlink" href="#prepare-changes" title="Permalink to this heading"></a></h3>
<p>The first step consists in preparing the <code class="docutils literal notranslate"><span class="pre">dev</span></code> branch for merge.</p>
<ol class="arabic simple">
<li><p>create a pull request <code class="docutils literal notranslate"><span class="pre">dev</span> <span class="pre">-&gt;</span> <span class="pre">main</span></code> named <code class="docutils literal notranslate"><span class="pre">Release</span> <span class="pre">X.Y.Z</span></code> (<code class="docutils literal notranslate"><span class="pre">Release</span> <span class="pre">X.Y.ZbI</span></code> is also accepted, X, Y, Z and I being numbers. Creating this pull request will trigger the <strong>pre-release</strong> workflows. The PR comment must indicate all major changes.</p></li>
<li><p>edit the <code class="docutils literal notranslate"><span class="pre">dev</span></code> branch until the pull requests checks (pipeline) all pass, effectively publishing all images to the preproduction Dockerhub registry</p></li>
<li><p>once all checks are good, the PR needs to be approved by a maintainer.</p></li>
</ol>
</section>
<section id="merge-changes">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Merge changes</a><a class="headerlink" href="#merge-changes" title="Permalink to this heading"></a></h3>
<p>Once the PR is approved and ready for merge, it can be merged</p>
<ol class="arabic simple">
<li><p>merge the PR with <strong>Create a merge commit</strong></p></li>
<li><p>Synchronize the <code class="docutils literal notranslate"><span class="pre">dev</span></code> branch with the latest <code class="docutils literal notranslate"><span class="pre">main</span></code> update with a <strong>fast-forward merge</strong></p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>pull<span class="w"> </span>--all
git<span class="w"> </span>checkout<span class="w"> </span>dev
git<span class="w"> </span>merge<span class="w"> </span>--ff-only<span class="w"> </span>main
git<span class="w"> </span>push
</pre></div>
</div>
</section>
<section id="new-tag">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">New tag</a><a class="headerlink" href="#new-tag" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">X.Y.Z</span></code> (or <code class="docutils literal notranslate"><span class="pre">X.Y.ZbI</span></code>) tag then needs to be placed on the same commit the <code class="docutils literal notranslate"><span class="pre">dev</span></code> and <code class="docutils literal notranslate"><span class="pre">main</span></code> branches point to.</p>
<p>Optionally, the “Annotated Tag Message” can be set to the PR initial comment with the <code class="docutils literal notranslate"><span class="pre">--file</span> <span class="pre">message.txt</span></code> argument in the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span></code> command below.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span><span class="s2">&quot;X.Y.Z&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>--tags
</pre></div>
</div>
<p>Puhing this tag will trigger the <strong>release</strong> workflow. Simply put, the workflow will migrate the images from preprod registry to production registry.</p>
<p>Maintainers needs to make sure workflow goes as planned and images end up in the prod Dockerhub registry. If the release fails for some reason, the tag can be deleted, changes pushed, and then the tag can be created again to trigger the release again (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">tag</span> <span class="pre">-d</span> <span class="pre">&quot;X.Y.Z&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">git</span> <span class="pre">push</span> <span class="pre">--delete</span> <span class="pre">origin</span> <span class="pre">&quot;X.Y.Z&quot;</span></code>).</p>
</section>
<section id="publish-release">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Publish release</a><a class="headerlink" href="#publish-release" title="Permalink to this heading"></a></h3>
<p>The final step is to create a “release” in github (<a class="reference external" href="https://github.com/ThePorgs/Exegol-images/releases/new">https://github.com/ThePorgs/Exegol-images/releases/new</a>).</p>
<ol class="arabic simple">
<li><p>The release must point to the tag created before.</p></li>
<li><p>The release must be named <code class="docutils literal notranslate"><span class="pre">Exegol</span> <span class="pre">images</span> <span class="pre">X.Y.Z</span></code>.</p></li>
<li><p>The release notes can be created with the <strong>Generate releases notes</strong> button.</p></li>
<li><p>Set it as <strong>latest release</strong>.</p></li>
<li><p>Publish</p></li>
</ol>
</section>
</section>
<section id="ci-cd-pipeline">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">CI/CD Pipeline</a><a class="headerlink" href="#ci-cd-pipeline" title="Permalink to this heading"></a></h2>
<p>The Exegol project relies on a continuous integration and continuous deployment (CI/CD) pipeline for multiple scenarios. At the time of writing, Tue 31 Jan 2023, the pipeline is structured as follows:</p>
<ul class="simple">
<li><p>the GitHub Actions platform is used on <a class="reference internal" href="../the-exegol-project/docker-images.html"><span class="doc">the Exegol-images submodule</span></a>. Its workflows allow to build and push images on <a class="reference external" href="https://hub.docker.com/repository/docker/nwodtuhs/exegol">the official Dockerhub registry</a>, run tests to make sure the tools are installed properly, run tests to help review pull requests, etc. GitHub Actions workflows are also being developped for packaging and publishing the Python wrapper on PyPI (<a class="reference external" href="https://pypi.org/project/Exegol">Exegol on PyPI</a>).</p></li>
<li><p>no pipeline(s) yet on the Python wrapper, resources, docs, etc. But it’s definitely in the roadmap.</p></li>
</ul>
<section id="github-actions">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">GitHub Actions</a><a class="headerlink" href="#github-actions" title="Permalink to this heading"></a></h3>
<p>The GitHub Actions pipeline(s) need runners to operate the various jobs configured for each workflow. The Exegol project relies on self-hosted runners instead of the GitHub-hosted runners mainly for costing reasons.</p>
<p>At the time of writing, Tue 31 Jan 2023, the Exegol-images pipeline(s) require ARM64 and AMD64 runners in order to build, and run corresponding architectured images.</p>
<section id="setting-up-secrets">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">1. Setting up secrets</a><a class="headerlink" href="#setting-up-secrets" title="Permalink to this heading"></a></h4>
<p>There are some operations that the runner will operate that will require authentication, including:
- pushing Python packages on PyPI
- pushing Docker images on Dockerhub</p>
<p>In order to allow this, GitHub Actions can be set up with secrets that the runner will be able to use later on. This part of the documentation shows what secrets must be set up and how.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">PyPI</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Dockerhub</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><p>API Tokens can be created in the maintainer account’s <a class="reference external" href="https://pypi.org/manage/account/">PyPI account settings</a>, in the <strong>API Tokens</strong> part. The scope must be set to <code class="docutils literal notranslate"><span class="pre">Project:</span> <span class="pre">Exegol</span></code>. The tokens are linked to the personal PyPI account.</p>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><p>Access Tokens can be created in the maintainer account’s <a class="reference external" href="https://hub.docker.com/settings/security">Dockerhub security settings</a>. Permissions must be set to <code class="docutils literal notranslate"><span class="pre">Read,</span> <span class="pre">Write,</span> <span class="pre">Delete</span></code>. The tokens are linked to the personal Dockerhub account.</p>
</div></div>
<p>Once the token is created, it can be added as follows:</p>
<ul class="simple">
<li><p>For Exegol-images, go to the <a class="reference external" href="https://github.com/ThePorgs/Exegol-images/settings/secrets/actions">Exegol-images repo settings &gt; secrets &gt; actions</a>. At the time of writing, 11 Feb. 2023, Dockerhub secrets are named <code class="docutils literal notranslate"><span class="pre">DOCKER_USERNAME</span></code> and <code class="docutils literal notranslate"><span class="pre">DOCKER_PASSWORD</span></code> in the workflows.</p></li>
<li><p>For the Python wrapper, go to the <a class="reference external" href="https://github.com/ThePorgs/Exegol/settings/secrets/actions">Exegol repo settings &gt; secrets &gt; actions</a>. At the time of writing, 11 Feb. 2023, the PyPI token is named <code class="docutils literal notranslate"><span class="pre">PYPI_API_TOKEN</span></code> in the workflows.</p></li>
</ul>
</section>
<section id="deploying-a-runner">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">2. Deploying a runner</a><a class="headerlink" href="#deploying-a-runner" title="Permalink to this heading"></a></h4>
<p>The runner can either run on macOS, Linux, or Windows, as those three operating systems are supporting by the GHA (GitHub Action) platform. x64 and ARM64 are supported for macOS and Windows, and for Linux, ARM is supported as well.</p>
<p>Below are the hardware requirements for each runner:</p>
<ul class="simple">
<li><p>enough RAM <em>(to be defined)</em></p></li>
<li><p>enough CPU <em>(to be defined)</em></p></li>
<li><p>enough free disk space (at least ~100GB, bare minimum)</p></li>
</ul>
<p>Before deploying a GHA agent on a runner, software requirements must be met:</p>
<ul class="simple">
<li><p>Docker (or Docker Desktop for Windows and macOS)</p></li>
<li><p>jq (lightweight and flexible command-line JSON processor)</p></li>
</ul>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">Linux</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">macOS</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><p>For Linux systems, Docker is required in order to have the GitHub Actions agent running.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Docker can be installed quickly and easily with the following command-line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-fsSL<span class="w"> </span><span class="s2">&quot;https://get.docker.com/&quot;</span><span class="w"> </span>-o<span class="w"> </span>get-docker.sh
sh<span class="w"> </span>get-docker.sh
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To run exegol from the user environment without <code class="docutils literal notranslate"><span class="pre">sudo</span></code>, the user must have privileged rights equivalent to root.
To grant yourself these rights, you can use the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># add the sudo group to the user</span>
sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="w"> </span>-n<span class="k">)</span>

<span class="c1"># &quot;reload&quot; the user groups</span>
newgrp
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">jq</span></code> utility is also required and can be installed with the following command line:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt<span class="w"> </span>install<span class="w"> </span>jq
</pre></div>
</div>
<p>Once the requirements are met, the agent can be deployed as follows (with sufficient permissions in the GitHub repository):</p>
<ul>
<li><p>go to <a class="reference external" href="https://github.com/ThePorgs/Exegol-images/settings/actions/runners">https://github.com/ThePorgs/Exegol-images/settings/actions/runners</a></p></li>
<li><p>click on “New self-hosted runner”</p></li>
<li><p>select <code class="docutils literal notranslate"><span class="pre">Linux</span></code> as operating system, as well as the right architecture and follow the instructions</p></li>
<li><p>when running the <code class="docutils literal notranslate"><span class="pre">config.sh</span></code> script, the following settings must be set</p>
<blockquote>
<div><ul class="simple">
<li><p>name of the runner group: Default</p></li>
<li><p>name of the runner: <em>up to you</em></p></li>
<li><p>additional labels: <code class="docutils literal notranslate"><span class="pre">builder,tester</span></code> (adapt this if the runner is to be used for only one of those actions). If the runner is an X64/AMD64, the <code class="docutils literal notranslate"><span class="pre">AMD64</span></code> tag needs to be set as well. If the runner is ARM64, the right tag will be set automatically.</p></li>
<li><p>name of work folder: <em>up to you</em></p></li>
</ul>
</div></blockquote>
</li>
<li><p>start the runner with the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script</p></li>
<li><p>(option) configure the agent as a service if it is to be run unattended/headless with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">./svc.sh</span> <span class="pre">install</span> <span class="pre">&lt;user&gt;</span></code>, more info at <a class="reference external" href="https://docs.github.com/en/actions/hosting-your-own-runners/configuring-the-self-hosted-runner-application-as-a-service">https://docs.github.com/en/actions/hosting-your-own-runners/configuring-the-self-hosted-runner-application-as-a-service</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When configuring the agent as a service, it will be enabled, meaning it will start at boot. The <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">is-enabled</span></code> command should return <code class="docutils literal notranslate"><span class="pre">enabled</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>is-enabled<span class="w"> </span>actions.runner.ThePorgs-Exegol-images.&lt;runner-name&gt;.service
</pre></div>
</div>
<p>In order to start the service, either reboot the runner, or use <code class="docutils literal notranslate"><span class="pre">systemctl</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>actions.runner.ThePorgs-Exegol-images.&lt;runner-name&gt;.service
</pre></div>
</div>
</div>
<img alt="Created a new runner" class="align-center" src="../_images/step_1.png" />
<img alt="Configuring the runner (GitHub)" class="align-center" src="../_images/step_2.png" />
<img alt="Configuring the runner (Local)" class="align-center" src="../_images/step_3.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Screenshots annotated with <a class="reference external" href="https://annotely.com/">https://annotely.com/</a></p>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><p>For macOS, <strong>Docker Desktop</strong> must be installed: <a class="reference external" href="https://docs.docker.com/desktop/install/mac-install/">https://docs.docker.com/desktop/install/mac-install/</a>.</p>
<ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">Settings</span> <span class="pre">&gt;</span> <span class="pre">Resources</span> <span class="pre">&gt;</span> <span class="pre">Advanced</span></code>, the <code class="docutils literal notranslate"><span class="pre">virtual</span> <span class="pre">disk</span> <span class="pre">limit</span></code> must be set to at least 100GB.</p></li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">Settings</span> <span class="pre">&gt;</span> <span class="pre">Resources</span> <span class="pre">&gt;</span> <span class="pre">Advanced</span></code>, allocate enough CPUs, Memory and Swap.</p></li>
</ul>
<p>The <strong>jq</strong> tool can be installed as follows.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># install brew</span>
ruby<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>&lt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null

<span class="c1"># install jq</span>
brew<span class="w"> </span>install<span class="w"> </span>jq
</pre></div>
</div>
<p><strong>Xcode Command Line Tools</strong> are also required, and they can be installed with the following command line.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xcode-select<span class="w"> </span>--install
</pre></div>
</div>
<p>Once the requirements are met, the agent can be deployed as follows (with sufficient permissions in the GitHub repository):</p>
<ul>
<li><p>go to <a class="reference external" href="https://github.com/ThePorgs/Exegol-images/settings/actions/runners">https://github.com/ThePorgs/Exegol-images/settings/actions/runners</a></p></li>
<li><p>click on “New self-hosted runner”</p></li>
<li><p>select <code class="docutils literal notranslate"><span class="pre">macOS</span></code> as operating system, as well as the right architecture and follow the instructions</p></li>
<li><p>when running the <code class="docutils literal notranslate"><span class="pre">config.sh</span></code> script, the following settings must be set</p>
<blockquote>
<div><ul class="simple">
<li><p>name of the runner group: Default</p></li>
<li><p>name of the runner: <em>up to you</em></p></li>
<li><p>additional labels: <code class="docutils literal notranslate"><span class="pre">builder,tester</span></code> (adapt this if the runner is to be used for only one of those actions). If the runner is an X64/AMD64, the <code class="docutils literal notranslate"><span class="pre">AMD64</span></code> tag needs to be set as well. If the runner is ARM64, the right tag will be set automatically.</p></li>
<li><p>name of work folder: <em>up to you</em></p></li>
</ul>
</div></blockquote>
</li>
<li><p>start the runner with the <code class="docutils literal notranslate"><span class="pre">run.sh</span></code> script</p></li>
<li><p>the agent must <strong>not</strong> be configured as a service with <code class="docutils literal notranslate"><span class="pre">./svc.sh</span> <span class="pre">install</span></code>. Some errors have been raised when setting up the pipeline like this.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>TODO</strong> : how to make that service run at boot unattended without using svc.sh install?</p>
</div>
</div></div>
</section>
<section id="checking-runners-status">
<h4><a class="toc-backref" href="#id20" role="doc-backlink">3. Checking runners status</a><a class="headerlink" href="#checking-runners-status" title="Permalink to this heading"></a></h4>
<p>Go to <a class="reference external" href="https://github.com/ThePorgs/Exegol-images/settings/actions/runners">https://github.com/ThePorgs/Exegol-images/settings/actions/runners</a></p>
</section>
<section id="understanding-the-pipelines">
<h4><a class="toc-backref" href="#id21" role="doc-backlink">4. Understanding the pipelines</a><a class="headerlink" href="#understanding-the-pipelines" title="Permalink to this heading"></a></h4>
<p><strong>TODO</strong> explain the pipelines, include diagrams.</p>
</section>
<section id="common-errors">
<h4><a class="toc-backref" href="#id22" role="doc-backlink">4. Common errors</a><a class="headerlink" href="#common-errors" title="Permalink to this heading"></a></h4>
<section id="docker-login">
<h5><a class="toc-backref" href="#id23" role="doc-backlink">1. docker login</a><a class="headerlink" href="#docker-login" title="Permalink to this heading"></a></h5>
<p>When configuring a macOS agent as a service with <code class="docutils literal notranslate"><span class="pre">./svc.sh</span> <span class="pre">install</span></code>, the following error was met during workflow run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Run docker/login-action@v2
with:
    username: ***
    password: ***
    ecr: auto
    logout: true
Logging into Docker Hub...
Error: Error saving credentials: error storing credentials - err: exit status 1, out: `error storing credentials - err: exit status 1, out: `User interaction is not allowed.``
</pre></div>
</div>
<p>In order to avoid that error, the runner was started interactively with <code class="docutils literal notranslate"><span class="pre">./run.sh</span></code>.</p>
</section>
<section id="disk-space">
<h5><a class="toc-backref" href="#id24" role="doc-backlink">2. Disk space</a><a class="headerlink" href="#disk-space" title="Permalink to this heading"></a></h5>
<p>When there’s not enough</p>
<p>You are running out of disk space. The runner will stop working when the machine runs out of disk space. Free space left: 62 MB</p>
</section>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="contributors.html" class="btn btn-neutral float-left" title="Contributors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sponsors.html" class="btn btn-neutral float-right" title="Sponsors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Shutdown &amp; Dramelac.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>